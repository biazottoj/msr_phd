{"url": "https://api.github.com/repos/apache/dubbo/issues/8387", "repository_url": "https://api.github.com/repos/apache/dubbo", "labels_url": "https://api.github.com/repos/apache/dubbo/issues/8387/labels{/name}", "comments_url": "https://api.github.com/repos/apache/dubbo/issues/8387/comments", "events_url": "https://api.github.com/repos/apache/dubbo/issues/8387/events", "html_url": "https://github.com/apache/dubbo/issues/8387", "id": 957506217, "node_id": "MDU6SXNzdWU5NTc1MDYyMTc=", "number": 8387, "title": "[3.0 Code Review] Service export & refer", "user": {"login": "plusmancn", "id": 4994682, "node_id": "MDQ6VXNlcjQ5OTQ2ODI=", "avatar_url": "https://avatars.githubusercontent.com/u/4994682?v=4", "gravatar_id": "", "url": "https://api.github.com/users/plusmancn", "html_url": "https://github.com/plusmancn", "followers_url": "https://api.github.com/users/plusmancn/followers", "following_url": "https://api.github.com/users/plusmancn/following{/other_user}", "gists_url": "https://api.github.com/users/plusmancn/gists{/gist_id}", "starred_url": "https://api.github.com/users/plusmancn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/plusmancn/subscriptions", "organizations_url": "https://api.github.com/users/plusmancn/orgs", "repos_url": "https://api.github.com/users/plusmancn/repos", "events_url": "https://api.github.com/users/plusmancn/events{/privacy}", "received_events_url": "https://api.github.com/users/plusmancn/received_events", "type": "User", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2021-08-01T14:28:48Z", "updated_at": "2021-08-27T09:44:00Z", "closed_at": "2021-08-27T06:28:03Z", "author_association": "CONTRIBUTOR", "active_lock_reason": null, "body": "### 1\uff09asyncExportFinish and asyncReferFinish should be with volatile keyword\r\nWith non-volatile there are no guarantees about the visibility of changes to variables across threads, which may result in the infinite while loop. Besides, using ThreadPool may be a better choice.\r\n\r\nhttps://github.com/apache/dubbo/blob/a4d86f8af464545b3065c54ed4525025aca9474e/dubbo-config/dubbo-config-api/src/main/java/org/apache/dubbo/config/bootstrap/DubboBootstrap.java#L193-L195\r\n\r\nhttps://github.com/apache/dubbo/blob/a4d86f8af464545b3065c54ed4525025aca9474e/dubbo-config/dubbo-config-api/src/main/java/org/apache/dubbo/config/bootstrap/DubboBootstrap.java#L1115-L1130\r\n\r\n### 2) When `NATIVE` option is enabled and we can't find the pre-generated class, the process should stop and throw an exception.\r\nBecause AdaptiveClassCodeGenerator can't work as expected in the GraalVM Native environment, if we let the application continue running, we will get the wrong result.\r\nhttps://github.com/apache/dubbo/blob/100655a888e7f30ed41f0d16a20dcc80103e7e0f/dubbo-common/src/main/java/org/apache/dubbo/common/extension/ExtensionLoader.java#L1103-L1116", "reactions": {"url": "https://api.github.com/repos/apache/dubbo/issues/8387/reactions", "total_count": 2, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 1}, "timeline_url": "https://api.github.com/repos/apache/dubbo/issues/8387/timeline", "performed_via_github_app": null, "state_reason": "completed", "score": 1.0, "key_in_body": false, "key_in_title": false, "key_in_comments": true}